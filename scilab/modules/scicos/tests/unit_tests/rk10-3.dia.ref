// =============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008 - INRIA
// Copyright (C) 2009 - DIGITEO
//
//  This file is distributed under the same license as the Scilab package.
// =============================================================================
// <-- ENGLISH IMPOSED -->
// Execute with exec("SCI/modules/xcos/tests/unit_tests/rk10-3.tst");
for i=1:5	// n, order
 for j=1:5	// K, initial slope
  for k=1:5	// tau, integration time
// RK + modification du contexte + sauvegarde
assert_checktrue(importXcosDiagram("SCI/modules/xcos/demos/ABrk10-3.zcos"));
scs_m.props.context = ["n = "+string(i)+";" "K = "+string(j)+";" "tau = "+string(k)+";"];
xcos_simulate(scs_m, 4);
rkval = rk.values;
time = rk.time;
// CVode + modification du contexte + sauvegarde
assert_checktrue(importXcosDiagram("SCI/modules/xcos/demos/ABcv10-3.zcos"));
scs_m.props.context = ["n = "+string(i)+";" "K = "+string(j)+";" "tau = "+string(k)+";"];
xcos_simulate(scs_m, 4);
cvval = cv.values;
compa = abs(rkval-cvval);
// Moyenne, Ecart-type, Max
moy = mean(compa);
[maxi, indmaxi] = max(compa);
ecarttype = st_deviation(compa);
if (maxi >= 0.0001) then bugmes();quit;end
vec = [moy, ecarttype];
maxiT = [maxi time(indmaxi)];
// Affichages
//disp("[moyenne, ecart-type] : ");
disp(vec);
//disp("[ecart max, au temps]: ");
//disp(maxiT);
  end
 end
end
 
    0.0000005    1.326D-08  
 
    0.0000006    1.950D-08  
 
    0.0000006    2.466D-08  
 
    0.0000005    2.524D-08  
 
    0.0000005    2.418D-08  
 
    0.0000010    2.653D-08  
 
    0.0000013    3.899D-08  
 
    0.0000012    4.932D-08  
 
    0.0000010    5.047D-08  
 
    0.0000009    4.837D-08  
 
    0.0000015    3.979D-08  
 
    0.0000019    5.849D-08  
 
    0.0000018    7.398D-08  
 
    0.0000016    7.571D-08  
 
    0.0000014    7.255D-08  
 
    0.0000021    5.305D-08  
 
    0.0000025    7.798D-08  
 
    0.0000023    9.864D-08  
 
    0.0000021    0.0000001  
 
    0.0000019    9.674D-08  
 
    0.0000026    6.631D-08  
 
    0.0000031    9.748D-08  
 
    0.0000029    0.0000001  
 
    0.0000026    0.0000001  
 
    0.0000023    0.0000001  
 
    0.0000008    1.673D-08  
 
    0.0000005    6.207D-08  
 
    0.0000001    2.983D-08  
 
    1.874D-08    1.016D-08  
 
    5.715D-08    1.499D-09  
 
    0.0000015    3.346D-08  
 
    0.0000011    0.0000001  
 
    0.0000002    5.966D-08  
 
    3.747D-08    2.031D-08  
 
    0.0000001    2.997D-09  
 
    0.0000023    5.019D-08  
 
    0.0000016    0.0000002  
 
    0.0000004    8.949D-08  
 
    5.621D-08    3.047D-08  
 
    0.0000002    4.496D-09  
 
    0.0000030    6.692D-08  
 
    0.0000022    0.0000002  
 
    0.0000005    0.0000001  
 
    7.495D-08    4.063D-08  
 
    0.0000002    5.995D-09  
 
    0.0000038    8.365D-08  
 
    0.0000027    0.0000003  
 
    0.0000006    0.0000001  
 
    9.368D-08    5.078D-08  
 
    0.0000003    7.493D-09  
 
    0.0000007    6.545D-08  
 
    3.078D-08    1.821D-08  
 
    9.753D-08    4.943D-09  
 
    6.439D-08    5.560D-09  
 
    4.128D-08    4.063D-09  
 
    0.0000014    0.0000001  
 
    6.156D-08    3.642D-08  
 
    0.0000002    9.887D-09  
 
    0.0000001    1.112D-08  
 
    8.256D-08    8.127D-09  
 
    0.0000021    0.0000002  
 
    9.234D-08    5.463D-08  
 
    0.0000003    1.483D-08  
 
    0.0000002    1.668D-08  
 
    0.0000001    1.219D-08  
 
    0.0000027    0.0000003  
 
    0.0000001    7.285D-08  
 
    0.0000004    1.977D-08  
 
    0.0000003    2.224D-08  
 
    0.0000002    1.625D-08  
 
    0.0000034    0.0000003  
 
    0.0000002    9.106D-08  
 
    0.0000005    2.472D-08  
 
    0.0000003    2.780D-08  
 
    0.0000002    2.032D-08  
 
    0.0000004    7.733D-08  
 
    0.0000001    4.000D-09  
 
    5.248D-08    4.624D-09  
 
    2.320D-08    2.647D-09  
 
    1.134D-08    1.393D-09  
 
    0.0000007    0.0000002  
 
    0.0000002    8.000D-09  
 
    0.0000001    9.248D-09  
 
    4.640D-08    5.294D-09  
 
    2.268D-08    2.787D-09  
 
    0.0000011    0.0000002  
 
    0.0000003    1.200D-08  
 
    0.0000002    1.387D-08  
 
    6.960D-08    7.942D-09  
 
    3.403D-08    4.180D-09  
 
    0.0000015    0.0000003  
 
    0.0000005    1.600D-08  
 
    0.0000002    1.850D-08  
 
    9.281D-08    1.059D-08  
 
    4.537D-08    5.574D-09  
 
    0.0000018    0.0000004  
 
    0.0000006    2.000D-08  
 
    0.0000003    2.312D-08  
 
    0.0000001    1.324D-08  
 
    5.671D-08    6.967D-09  
 
    9.723D-08    5.590D-08  
 
    8.658D-08    7.322D-09  
 
    2.066D-08    2.402D-09  
 
 10^(-8) *
 
    0.6551604    0.0854215  
 
 10^(-8) *
 
    0.2525075    0.0353114  
 
    0.0000002    0.0000001  
 
    0.0000002    1.464D-08  
 
    4.132D-08    4.804D-09  
 
    1.310D-08    1.708D-09  
 
 10^(-8) *
 
    0.5050149    0.0706228  
 
    0.0000003    0.0000002  
 
    0.0000003    2.197D-08  
 
    6.197D-08    7.206D-09  
 
    1.965D-08    2.563D-09  
 
 10^(-8) *
 
    0.7575224    0.1059342  
 
    0.0000004    0.0000002  
 
    0.0000003    2.929D-08  
 
    8.263D-08    9.608D-09  
 
    2.621D-08    3.417D-09  
 
    1.010D-08    1.412D-09  
 
    0.0000005    0.0000003  
 
    0.0000004    3.661D-08  
 
    0.0000001    1.201D-08  
 
    3.276D-08    4.271D-09  
 
    1.263D-08    1.766D-09  
