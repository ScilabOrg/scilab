// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008-2009 - INRIA - Michael Baudin
// Copyright (C) 2011 - DIGITEO - Michael Baudin
//
// This file must be used under the terms of the CeCILL.
// This source file is licensed as described in the file COPYING, which
// you should have received as part of this distribution.  The terms
// are also available at
// http://www.cecill.info/licences/Licence_CeCILL_V2-en.txt
// <-- JVM NOT MANDATORY -->
function [ y , index ] = squarefun ( x , index )
y = x(1)^2+x(2)^2;
endfunction
nm = neldermead_new ();
nm = neldermead_configure(nm,"-numberofvariables",2);
nm = neldermead_configure(nm,"-x0",[1.0 1.0]');
nm = neldermead_configure(nm,"-simplex0method","axes");
nm = neldermead_configure(nm,"-simplex0length",0.5);
nm = neldermead_configure(nm,"-method","fixed");
nm = neldermead_configure(nm,"-function",squarefun);
nm = neldermead_search(nm);
xopt = neldermead_get(nm,"-xopt");
assert_checkalmostequal ( xopt , [0.0;0.0], 1e-6 );
fopt = neldermead_get(nm,"-fopt");
assert_checkalmostequal ( fopt , 0.0, 1e-6 );
nm = neldermead_destroy(nm);
//
// Interrupt the algorithm when done.
nm = neldermead_new ();
nm = neldermead_configure(nm,"-numberofvariables",2);
nm = neldermead_configure(nm,"-x0",[1.0 1.0]');
nm = neldermead_configure(nm,"-method","fixed");
nm = neldermead_configure(nm,"-function",squarefun);
// Reduce number of displayed digits to increase 
// portability of the test.
format("v",9);
nm = neldermead_configure(nm,"-verbose",1);
// Set the relative size to zero: it should never stop...
nm = neldermead_configure(nm,"-tolsimplexizerelative",0.0);
nm = neldermead_search(nm);
Function Evaluation #1 at [1 1]
Function Evaluation #2 at [1 1]
Function Evaluation #3 at [1 1]
Function Evaluation #4 at [2 1]
Function Evaluation #5 at [1 2]
Sort
=================================================================
Iteration #1 (total = 1)
Function Eval #5
Xopt : [1 1]
Fopt : 2
DeltaFv : 3
Center : [1.333333 1.333333]
Size : 1
Optim Simplex Object:
=====================
Vertex #1/3 : fv=2, x=1 1
Vertex #2/3 : fv=5, x=2 1
Vertex #3/3 : fv=5, x=1 2
Reflect
xbar=1.5 1
Function Evaluation #6 at [2 0]
xr=2 0, f(xr)=4.000000
  > Perform reflect
=================================================================
Iteration #2 (total = 2)
Function Eval #6
Xopt : [1 1]
Fopt : 2
DeltaFv : 3
Center : [1.666667 0.666667]
Size : 1.414214
Optim Simplex Object:
=====================
Vertex #1/3 : fv=2, x=1 1
Vertex #2/3 : fv=4, x=2 0
Vertex #3/3 : fv=5, x=2 1
Reflect
xbar=1.5 0.5
Function Evaluation #7 at [1 0]
xr=1 0, f(xr)=1.000000
  > Perform reflect
=================================================================
Iteration #3 (total = 3)
Function Eval #7
Xopt : [1 0]
Fopt : 1
DeltaFv : 3
Center : [1.333333 0.333333]
Size : 1
Optim Simplex Object:
=====================
Vertex #1/3 : fv=1, x=1 0
Vertex #2/3 : fv=2, x=1 1
Vertex #3/3 : fv=4, x=2 0
Reflect
xbar=1 0.5
Function Evaluation #8 at [0 1]
xr=0 1, f(xr)=1.000000
  > Perform reflect
=================================================================
Iteration #4 (total = 4)
Function Eval #8
Xopt : [1 0]
Fopt : 1
DeltaFv : 1
Center : [0.666667 0.666667]
Size : 1.414214
Optim Simplex Object:
=====================
Vertex #1/3 : fv=1, x=1 0
Vertex #2/3 : fv=1, x=0 1
Vertex #3/3 : fv=2, x=1 1
Reflect
xbar=0.5 0.5
Function Evaluation #9 at [0 0]
xr=0 0, f(xr)=0.000000
  > Perform reflect
=================================================================
Iteration #5 (total = 5)
Function Eval #9
Xopt : [0 0]
Fopt : 0
DeltaFv : 1
Center : [0.333333 0.333333]
Size : 1
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1, x=1 0
Vertex #3/3 : fv=1, x=0 1
Reflect
xbar=0.5 0
Function Evaluation #10 at [1 -1]
xr=1 -1, f(xr)=2.000000
xbar2=0 0.5
Function Evaluation #11 at [-1 1]
xr2=-1 1, f(xr2)=2.000000
  > Perform Shrink
Function Evaluation #12 at [0.5 0]
Function Evaluation #13 at [0 0.5]
=================================================================
Iteration #6 (total = 6)
Function Eval #13
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.25
Center : [0.166667 0.166667]
Size : 0.5
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.25, x=0.5 0
Vertex #3/3 : fv=0.25, x=0 0.5
Reflect
xbar=0.25 0
Function Evaluation #14 at [0.5 -0.5]
xr=0.5 -0.5, f(xr)=0.500000
xbar2=0 0.25
Function Evaluation #15 at [-0.5 0.5]
xr2=-0.5 0.5, f(xr2)=0.500000
  > Perform Shrink
Function Evaluation #16 at [0.25 0]
Function Evaluation #17 at [0 0.25]
=================================================================
Iteration #7 (total = 7)
Function Eval #17
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.0625
Center : [0.083333 0.083333]
Size : 0.25
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.0625, x=0.25 0
Vertex #3/3 : fv=0.0625, x=0 0.25
Reflect
xbar=0.125 0
Function Evaluation #18 at [0.25 -0.25]
xr=0.25 -0.25, f(xr)=0.125000
xbar2=0 0.125
Function Evaluation #19 at [-0.25 0.25]
xr2=-0.25 0.25, f(xr2)=0.125000
  > Perform Shrink
Function Evaluation #20 at [0.125 0]
Function Evaluation #21 at [0 0.125]
=================================================================
Iteration #8 (total = 8)
Function Eval #21
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.015625
Center : [0.041667 0.041667]
Size : 0.125
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.015625, x=0.125 0
Vertex #3/3 : fv=0.015625, x=0 0.125
Reflect
xbar=0.0625 0
Function Evaluation #22 at [0.125 -0.125]
xr=0.125 -0.125, f(xr)=0.031250
xbar2=0 0.0625
Function Evaluation #23 at [-0.125 0.125]
xr2=-0.125 0.125, f(xr2)=0.031250
  > Perform Shrink
Function Evaluation #24 at [0.0625 0]
Function Evaluation #25 at [0 0.0625]
=================================================================
Iteration #9 (total = 9)
Function Eval #25
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.003906
Center : [0.020833 0.020833]
Size : 0.0625
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.003906, x=0.0625 0
Vertex #3/3 : fv=0.003906, x=0 0.0625
Reflect
xbar=0.03125 0
Function Evaluation #26 at [0.0625 -0.0625]
xr=0.0625 -0.0625, f(xr)=0.007813
xbar2=0 0.03125
Function Evaluation #27 at [-0.0625 0.0625]
xr2=-0.0625 0.0625, f(xr2)=0.007813
  > Perform Shrink
Function Evaluation #28 at [0.03125 0]
Function Evaluation #29 at [0 0.03125]
=================================================================
Iteration #10 (total = 10)
Function Eval #29
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.000977
Center : [0.010417 0.010417]
Size : 0.03125
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.000977, x=0.03125 0
Vertex #3/3 : fv=0.000977, x=0 0.03125
Reflect
xbar=0.015625 0
Function Evaluation #30 at [0.03125 -0.03125]
xr=0.03125 -0.03125, f(xr)=0.001953
xbar2=0 0.015625
Function Evaluation #31 at [-0.03125 0.03125]
xr2=-0.03125 0.03125, f(xr2)=0.001953
  > Perform Shrink
Function Evaluation #32 at [0.015625 0]
Function Evaluation #33 at [0 0.015625]
=================================================================
Iteration #11 (total = 11)
Function Eval #33
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.000244
Center : [0.005208 0.005208]
Size : 0.015625
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.000244, x=0.015625 0
Vertex #3/3 : fv=0.000244, x=0 0.015625
Reflect
xbar=0.007812 0
Function Evaluation #34 at [0.015625 -0.015625]
xr=0.015625 -0.015625, f(xr)=0.000488
xbar2=0 0.007812
Function Evaluation #35 at [-0.015625 0.015625]
xr2=-0.015625 0.015625, f(xr2)=0.000488
  > Perform Shrink
Function Evaluation #36 at [0.007812 0]
Function Evaluation #37 at [0 0.007812]
=================================================================
Iteration #12 (total = 12)
Function Eval #37
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.000061
Center : [0.002604 0.002604]
Size : 0.007812
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.000061, x=0.007813 0
Vertex #3/3 : fv=0.000061, x=0 0.007813
Reflect
xbar=0.003906 0
Function Evaluation #38 at [0.007812 -0.007812]
xr=0.007812 -0.007812, f(xr)=0.000122
xbar2=0 0.003906
Function Evaluation #39 at [-0.007812 0.007812]
xr2=-0.007812 0.007812, f(xr2)=0.000122
  > Perform Shrink
Function Evaluation #40 at [0.003906 0]
Function Evaluation #41 at [0 0.003906]
=================================================================
Iteration #13 (total = 13)
Function Eval #41
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.000015
Center : [0.001302 0.001302]
Size : 0.003906
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.000015, x=0.003906 0
Vertex #3/3 : fv=0.000015, x=0 0.003906
Reflect
xbar=0.001953 0
Function Evaluation #42 at [0.003906 -0.003906]
xr=0.003906 -0.003906, f(xr)=0.000031
xbar2=0 0.001953
Function Evaluation #43 at [-0.003906 0.003906]
xr2=-0.003906 0.003906, f(xr2)=0.000031
  > Perform Shrink
Function Evaluation #44 at [0.001953 0]
Function Evaluation #45 at [0 0.001953]
=================================================================
Iteration #14 (total = 14)
Function Eval #45
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.000004
Center : [0.000651 0.000651]
Size : 0.001953
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.000004, x=0.001953 0
Vertex #3/3 : fv=0.000004, x=0 0.001953
Reflect
xbar=0.000977 0
Function Evaluation #46 at [0.001953 -0.001953]
xr=0.001953 -0.001953, f(xr)=0.000008
xbar2=0 0.000977
Function Evaluation #47 at [-0.001953 0.001953]
xr2=-0.001953 0.001953, f(xr2)=0.000008
  > Perform Shrink
Function Evaluation #48 at [0.000977 0]
Function Evaluation #49 at [0 0.000977]
=================================================================
Iteration #15 (total = 15)
Function Eval #49
Xopt : [0 0]
Fopt : 0
DeltaFv : 9.54D-07
Center : [0.000326 0.000326]
Size : 0.000977
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=9.54D-07, x=0.000977 0
Vertex #3/3 : fv=9.54D-07, x=0 0.000977
Reflect
xbar=0.000488 0
Function Evaluation #50 at [0.000977 -0.000977]
xr=0.000977 -0.000977, f(xr)=0.000002
xbar2=0 0.000488
Function Evaluation #51 at [-0.000977 0.000977]
xr2=-0.000977 0.000977, f(xr2)=0.000002
  > Perform Shrink
Function Evaluation #52 at [0.000488 0]
Function Evaluation #53 at [0 0.000488]
=================================================================
Iteration #16 (total = 16)
Function Eval #53
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.38D-07
Center : [0.000163 0.000163]
Size : 0.000488
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.38D-07, x=0.000488 0
Vertex #3/3 : fv=2.38D-07, x=0 0.000488
Reflect
xbar=0.000244 0
Function Evaluation #54 at [0.000488 -0.000488]
xr=0.000488 -0.000488, f(xr)=0.000000
xbar2=0 0.000244
Function Evaluation #55 at [-0.000488 0.000488]
xr2=-0.000488 0.000488, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #56 at [0.000244 0]
Function Evaluation #57 at [0 0.000244]
=================================================================
Iteration #17 (total = 17)
Function Eval #57
Xopt : [0 0]
Fopt : 0
DeltaFv : 5.96D-08
Center : [0.000081 0.000081]
Size : 0.000244
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=5.96D-08, x=0.000244 0
Vertex #3/3 : fv=5.96D-08, x=0 0.000244
Reflect
xbar=0.000122 0
Function Evaluation #58 at [0.000244 -0.000244]
xr=0.000244 -0.000244, f(xr)=0.000000
xbar2=0 0.000122
Function Evaluation #59 at [-0.000244 0.000244]
xr2=-0.000244 0.000244, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #60 at [0.000122 0]
Function Evaluation #61 at [0 0.000122]
=================================================================
Iteration #18 (total = 18)
Function Eval #61
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.49D-08
Center : [0.000041 0.000041]
Size : 0.000122
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.49D-08, x=0.000122 0
Vertex #3/3 : fv=1.49D-08, x=0 0.000122
Reflect
xbar=0.000061 0
Function Evaluation #62 at [0.000122 -0.000122]
xr=0.000122 -0.000122, f(xr)=0.000000
xbar2=0 0.000061
Function Evaluation #63 at [-0.000122 0.000122]
xr2=-0.000122 0.000122, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #64 at [0.000061 0]
Function Evaluation #65 at [0 0.000061]
=================================================================
Iteration #19 (total = 19)
Function Eval #65
Xopt : [0 0]
Fopt : 0
DeltaFv : 3.73D-09
Center : [0.000020 0.000020]
Size : 0.000061
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=3.73D-09, x=0.000061 0
Vertex #3/3 : fv=3.73D-09, x=0 0.000061
Reflect
xbar=0.000031 0
Function Evaluation #66 at [0.000061 -0.000061]
xr=0.000061 -0.000061, f(xr)=0.000000
xbar2=0 0.000031
Function Evaluation #67 at [-0.000061 0.000061]
xr2=-0.000061 0.000061, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #68 at [0.000031 0]
Function Evaluation #69 at [0 0.000031]
=================================================================
Iteration #20 (total = 20)
Function Eval #69
Xopt : [0 0]
Fopt : 0
DeltaFv : 9.31D-10
Center : [0.000010 0.000010]
Size : 0.000031
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=9.31D-10, x=0.000031 0
Vertex #3/3 : fv=9.31D-10, x=0 0.000031
Reflect
xbar=0.000015 0
Function Evaluation #70 at [0.000031 -0.000031]
xr=0.000031 -0.000031, f(xr)=0.000000
xbar2=0 0.000015
Function Evaluation #71 at [-0.000031 0.000031]
xr2=-0.000031 0.000031, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #72 at [0.000015 0]
Function Evaluation #73 at [0 0.000015]
=================================================================
Iteration #21 (total = 21)
Function Eval #73
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.33D-10
Center : [0.000005 0.000005]
Size : 0.000015
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.33D-10, x=0.000015 0
Vertex #3/3 : fv=2.33D-10, x=0 0.000015
Reflect
xbar=0.000008 0
Function Evaluation #74 at [0.000015 -0.000015]
xr=0.000015 -0.000015, f(xr)=0.000000
xbar2=0 0.000008
Function Evaluation #75 at [-0.000015 0.000015]
xr2=-0.000015 0.000015, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #76 at [0.000008 0]
Function Evaluation #77 at [0 0.000008]
=================================================================
Iteration #22 (total = 22)
Function Eval #77
Xopt : [0 0]
Fopt : 0
DeltaFv : 5.82D-11
Center : [0.000003 0.000003]
Size : 0.000008
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=5.82D-11, x=0.000008 0
Vertex #3/3 : fv=5.82D-11, x=0 0.000008
Reflect
xbar=0.000004 0
Function Evaluation #78 at [0.000008 -0.000008]
xr=0.000008 -0.000008, f(xr)=0.000000
xbar2=0 0.000004
Function Evaluation #79 at [-0.000008 0.000008]
xr2=-0.000008 0.000008, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #80 at [0.000004 0]
Function Evaluation #81 at [0 0.000004]
=================================================================
Iteration #23 (total = 23)
Function Eval #81
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.46D-11
Center : [0.000001 0.000001]
Size : 0.000004
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.46D-11, x=0.000004 0
Vertex #3/3 : fv=1.46D-11, x=0 0.000004
Reflect
xbar=0.000002 0
Function Evaluation #82 at [0.000004 -0.000004]
xr=0.000004 -0.000004, f(xr)=0.000000
xbar2=0 0.000002
Function Evaluation #83 at [-0.000004 0.000004]
xr2=-0.000004 0.000004, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #84 at [0.000002 0]
Function Evaluation #85 at [0 0.000002]
=================================================================
Iteration #24 (total = 24)
Function Eval #85
Xopt : [0 0]
Fopt : 0
DeltaFv : 3.64D-12
Center : [6.36D-07 6.36D-07]
Size : 0.000002
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=3.64D-12, x=0.000002 0
Vertex #3/3 : fv=3.64D-12, x=0 0.000002
Reflect
xbar=9.54D-07 0
Function Evaluation #86 at [0.000002 -0.000002]
xr=0.000002 -0.000002, f(xr)=0.000000
xbar2=0 9.54D-07
Function Evaluation #87 at [-0.000002 0.000002]
xr2=-0.000002 0.000002, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #88 at [9.54D-07 0]
Function Evaluation #89 at [0 9.54D-07]
=================================================================
Iteration #25 (total = 25)
Function Eval #89
Xopt : [0 0]
Fopt : 0
DeltaFv : 9.09D-13
Center : [3.18D-07 3.18D-07]
Size : 9.54D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=9.09D-13, x=9.54D-07 0
Vertex #3/3 : fv=9.09D-13, x=0 9.54D-07
Reflect
xbar=4.77D-07 0
Function Evaluation #90 at [9.54D-07 -9.54D-07]
xr=9.54D-07 -9.54D-07, f(xr)=0.000000
xbar2=0 4.77D-07
Function Evaluation #91 at [-9.54D-07 9.54D-07]
xr2=-9.54D-07 9.54D-07, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #92 at [4.77D-07 0]
Function Evaluation #93 at [0 4.77D-07]
=================================================================
Iteration #26 (total = 26)
Function Eval #93
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.27D-13
Center : [1.59D-07 1.59D-07]
Size : 4.77D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.27D-13, x=4.77D-07 0
Vertex #3/3 : fv=2.27D-13, x=0 4.77D-07
Reflect
xbar=2.38D-07 0
Function Evaluation #94 at [4.77D-07 -4.77D-07]
xr=4.77D-07 -4.77D-07, f(xr)=0.000000
xbar2=0 2.38D-07
Function Evaluation #95 at [-4.77D-07 4.77D-07]
xr2=-4.77D-07 4.77D-07, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #96 at [2.38D-07 0]
Function Evaluation #97 at [0 2.38D-07]
=================================================================
Iteration #27 (total = 27)
Function Eval #97
Xopt : [0 0]
Fopt : 0
DeltaFv : 5.68D-14
Center : [7.95D-08 7.95D-08]
Size : 2.38D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=5.68D-14, x=2.38D-07 0
Vertex #3/3 : fv=5.68D-14, x=0 2.38D-07
Reflect
xbar=1.19D-07 0
Function Evaluation #98 at [2.38D-07 -2.38D-07]
xr=2.38D-07 -2.38D-07, f(xr)=0.000000
xbar2=0 1.19D-07
Function Evaluation #99 at [-2.38D-07 2.38D-07]
xr2=-2.38D-07 2.38D-07, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #100 at [1.19D-07 0]
Function Evaluation #101 at [0 1.19D-07]
=================================================================
Iteration #28 (total = 28)
Function Eval #101
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.42D-14
Center : [3.97D-08 3.97D-08]
Size : 1.19D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.42D-14, x=1.19D-07 0
Vertex #3/3 : fv=1.42D-14, x=0 1.19D-07
Terminate with status : maxfuneval
xopt = neldermead_get(nm,"-xopt");
assert_checkalmostequal ( xopt , [0.0;0.0], 1e-6 );
fopt = neldermead_get(nm,"-fopt");
assert_checkalmostequal ( fopt , 0.0, 1e-6 );
nm = neldermead_destroy(nm);
