// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008-2009 - INRIA - Michael Baudin
// Copyright (C) 2011 - DIGITEO - Michael Baudin
//
// This file must be used under the terms of the CeCILL.
// This source file is licensed as described in the file COPYING, which
// you should have received as part of this distribution.  The terms
// are also available at
// http://www.cecill.info/licences/Licence_CeCILL_V2-en.txt
// <-- JVM NOT MANDATORY -->
function [ y , index ] = squarefun ( x , index )
y = x(1)^2+x(2)^2;
endfunction
nm = neldermead_new ();
nm = neldermead_configure(nm,"-numberofvariables",2);
nm = neldermead_configure(nm,"-x0",[1.0 1.0]');
nm = neldermead_configure(nm,"-simplex0method","axes");
nm = neldermead_configure(nm,"-simplex0length",0.5);
nm = neldermead_configure(nm,"-method","fixed");
nm = neldermead_configure(nm,"-function",squarefun);
nm = neldermead_search(nm);
xopt = neldermead_get(nm,"-xopt");
assert_checkalmostequal ( xopt , [0.0;0.0], 1e-6 );
fopt = neldermead_get(nm,"-fopt");
assert_checkalmostequal ( fopt , 0.0, 1e-6 );
nm = neldermead_destroy(nm);
//
// Interrupt the algorithm when done.
nm = neldermead_new ();
nm = neldermead_configure(nm,"-numberofvariables",2);
nm = neldermead_configure(nm,"-x0",[1.0 1.0]');
nm = neldermead_configure(nm,"-method","fixed");
nm = neldermead_configure(nm,"-function",squarefun);
// Reduce number of displayed digits to increase 
// portability of the test.
format("v",7);
nm = neldermead_configure(nm,"-verbose",1);
// Set the relative size to zero: it should never stop...
nm = neldermead_configure(nm,"-tolsimplexizerelative",0.0);
nm = neldermead_search(nm);
Function Evaluation #1 at [1 1]
Function Evaluation #2 at [1 1]
Function Evaluation #3 at [1 1]
Function Evaluation #4 at [2 1]
Function Evaluation #5 at [1 2]
Sort
=================================================================
Iteration #1 (total = 1)
Function Eval #5
Xopt : [1 1]
Fopt : 2
DeltaFv : 3
Center : [1.3333 1.3333]
Size : 1
Optim Simplex Object:
=====================
Vertex #1/3 : fv=2, x=1 1
Vertex #2/3 : fv=5, x=2 1
Vertex #3/3 : fv=5, x=1 2
Reflect
xbar=1.5 1
Function Evaluation #6 at [2 0]
xr=2 0, f(xr)=4.000000
  > Perform reflect
=================================================================
Iteration #2 (total = 2)
Function Eval #6
Xopt : [1 1]
Fopt : 2
DeltaFv : 3
Center : [1.6667 0.6667]
Size : 1.4142
Optim Simplex Object:
=====================
Vertex #1/3 : fv=2, x=1 1
Vertex #2/3 : fv=4, x=2 0
Vertex #3/3 : fv=5, x=2 1
Reflect
xbar=1.5 0.5
Function Evaluation #7 at [1 0]
xr=1 0, f(xr)=1.000000
  > Perform reflect
=================================================================
Iteration #3 (total = 3)
Function Eval #7
Xopt : [1 0]
Fopt : 1
DeltaFv : 3
Center : [1.3333 0.3333]
Size : 1
Optim Simplex Object:
=====================
Vertex #1/3 : fv=1, x=1 0
Vertex #2/3 : fv=2, x=1 1
Vertex #3/3 : fv=4, x=2 0
Reflect
xbar=1 0.5
Function Evaluation #8 at [0 1]
xr=0 1, f(xr)=1.000000
  > Perform reflect
=================================================================
Iteration #4 (total = 4)
Function Eval #8
Xopt : [1 0]
Fopt : 1
DeltaFv : 1
Center : [0.6667 0.6667]
Size : 1.4142
Optim Simplex Object:
=====================
Vertex #1/3 : fv=1, x=1 0
Vertex #2/3 : fv=1, x=0 1
Vertex #3/3 : fv=2, x=1 1
Reflect
xbar=0.5 0.5
Function Evaluation #9 at [0 0]
xr=0 0, f(xr)=0.000000
  > Perform reflect
=================================================================
Iteration #5 (total = 5)
Function Eval #9
Xopt : [0 0]
Fopt : 0
DeltaFv : 1
Center : [0.3333 0.3333]
Size : 1
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1, x=1 0
Vertex #3/3 : fv=1, x=0 1
Reflect
xbar=0.5 0
Function Evaluation #10 at [1 -1]
xr=1 -1, f(xr)=2.000000
xbar2=0 0.5
Function Evaluation #11 at [-1 1]
xr2=-1 1, f(xr2)=2.000000
  > Perform Shrink
Function Evaluation #12 at [0.5 0]
Function Evaluation #13 at [0 0.5]
=================================================================
Iteration #6 (total = 6)
Function Eval #13
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.25
Center : [0.1667 0.1667]
Size : 0.5
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.25, x=0.5 0
Vertex #3/3 : fv=0.25, x=0 0.5
Reflect
xbar=0.25 0
Function Evaluation #14 at [0.5 -0.5]
xr=0.5 -0.5, f(xr)=0.500000
xbar2=0 0.25
Function Evaluation #15 at [-0.5 0.5]
xr2=-0.5 0.5, f(xr2)=0.500000
  > Perform Shrink
Function Evaluation #16 at [0.25 0]
Function Evaluation #17 at [0 0.25]
=================================================================
Iteration #7 (total = 7)
Function Eval #17
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.0625
Center : [0.0833 0.0833]
Size : 0.25
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.0625, x=0.25 0
Vertex #3/3 : fv=0.0625, x=0 0.25
Reflect
xbar=0.125 0
Function Evaluation #18 at [0.25 -0.25]
xr=0.25 -0.25, f(xr)=0.125000
xbar2=0 0.125
Function Evaluation #19 at [-0.25 0.25]
xr2=-0.25 0.25, f(xr2)=0.125000
  > Perform Shrink
Function Evaluation #20 at [0.125 0]
Function Evaluation #21 at [0 0.125]
=================================================================
Iteration #8 (total = 8)
Function Eval #21
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.0156
Center : [0.0417 0.0417]
Size : 0.125
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.0156, x=0.125 0
Vertex #3/3 : fv=0.0156, x=0 0.125
Reflect
xbar=0.0625 0
Function Evaluation #22 at [0.125 -0.125]
xr=0.125 -0.125, f(xr)=0.031250
xbar2=0 0.0625
Function Evaluation #23 at [-0.125 0.125]
xr2=-0.125 0.125, f(xr2)=0.031250
  > Perform Shrink
Function Evaluation #24 at [0.0625 0]
Function Evaluation #25 at [0 0.0625]
=================================================================
Iteration #9 (total = 9)
Function Eval #25
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.0039
Center : [0.0208 0.0208]
Size : 0.0625
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.0039, x=0.0625 0
Vertex #3/3 : fv=0.0039, x=0 0.0625
Reflect
xbar=0.0312 0
Function Evaluation #26 at [0.0625 -0.0625]
xr=0.0625 -0.0625, f(xr)=0.007813
xbar2=0 0.0312
Function Evaluation #27 at [-0.0625 0.0625]
xr2=-0.0625 0.0625, f(xr2)=0.007813
  > Perform Shrink
Function Evaluation #28 at [0.0312 0]
Function Evaluation #29 at [0 0.0312]
=================================================================
Iteration #10 (total = 10)
Function Eval #29
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.0010
Center : [0.0104 0.0104]
Size : 0.0312
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.0010, x=0.0313 0
Vertex #3/3 : fv=0.0010, x=0 0.0313
Reflect
xbar=0.0156 0
Function Evaluation #30 at [0.0312 -0.0312]
xr=0.0312 -0.0312, f(xr)=0.001953
xbar2=0 0.0156
Function Evaluation #31 at [-0.0312 0.0312]
xr2=-0.0312 0.0312, f(xr2)=0.001953
  > Perform Shrink
Function Evaluation #32 at [0.0156 0]
Function Evaluation #33 at [0 0.0156]
=================================================================
Iteration #11 (total = 11)
Function Eval #33
Xopt : [0 0]
Fopt : 0
DeltaFv : 0.0002
Center : [0.0052 0.0052]
Size : 0.0156
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=0.0002, x=0.0156 0
Vertex #3/3 : fv=0.0002, x=0 0.0156
Reflect
xbar=0.0078 0
Function Evaluation #34 at [0.0156 -0.0156]
xr=0.0156 -0.0156, f(xr)=0.000488
xbar2=0 0.0078
Function Evaluation #35 at [-0.0156 0.0156]
xr2=-0.0156 0.0156, f(xr2)=0.000488
  > Perform Shrink
Function Evaluation #36 at [0.0078 0]
Function Evaluation #37 at [0 0.0078]
=================================================================
Iteration #12 (total = 12)
Function Eval #37
Xopt : [0 0]
Fopt : 0
DeltaFv : 6.D-05
Center : [0.0026 0.0026]
Size : 0.0078
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=6.D-05, x=0.0078 0
Vertex #3/3 : fv=6.D-05, x=0 0.0078
Reflect
xbar=0.0039 0
Function Evaluation #38 at [0.0078 -0.0078]
xr=0.0078 -0.0078, f(xr)=0.000122
xbar2=0 0.0039
Function Evaluation #39 at [-0.0078 0.0078]
xr2=-0.0078 0.0078, f(xr2)=0.000122
  > Perform Shrink
Function Evaluation #40 at [0.0039 0]
Function Evaluation #41 at [0 0.0039]
=================================================================
Iteration #13 (total = 13)
Function Eval #41
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.D-05
Center : [0.0013 0.0013]
Size : 0.0039
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.D-05, x=0.0039 0
Vertex #3/3 : fv=2.D-05, x=0 0.0039
Reflect
xbar=0.0020 0
Function Evaluation #42 at [0.0039 -0.0039]
xr=0.0039 -0.0039, f(xr)=0.000031
xbar2=0 0.0020
Function Evaluation #43 at [-0.0039 0.0039]
xr2=-0.0039 0.0039, f(xr2)=0.000031
  > Perform Shrink
Function Evaluation #44 at [0.0020 0]
Function Evaluation #45 at [0 0.0020]
=================================================================
Iteration #14 (total = 14)
Function Eval #45
Xopt : [0 0]
Fopt : 0
DeltaFv : 4.D-06
Center : [0.0007 0.0007]
Size : 0.0020
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=4.D-06, x=0.0020 0
Vertex #3/3 : fv=4.D-06, x=0 0.0020
Reflect
xbar=0.0010 0
Function Evaluation #46 at [0.0020 -0.0020]
xr=0.0020 -0.0020, f(xr)=0.000008
xbar2=0 0.0010
Function Evaluation #47 at [-0.0020 0.0020]
xr2=-0.0020 0.0020, f(xr2)=0.000008
  > Perform Shrink
Function Evaluation #48 at [0.0010 0]
Function Evaluation #49 at [0 0.0010]
=================================================================
Iteration #15 (total = 15)
Function Eval #49
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.D-06
Center : [0.0003 0.0003]
Size : 0.0010
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.D-06, x=0.0010 0
Vertex #3/3 : fv=1.D-06, x=0 0.0010
Reflect
xbar=0.0005 0
Function Evaluation #50 at [0.0010 -0.0010]
xr=0.0010 -0.0010, f(xr)=0.000002
xbar2=0 0.0005
Function Evaluation #51 at [-0.0010 0.0010]
xr2=-0.0010 0.0010, f(xr2)=0.000002
  > Perform Shrink
Function Evaluation #52 at [0.0005 0]
Function Evaluation #53 at [0 0.0005]
=================================================================
Iteration #16 (total = 16)
Function Eval #53
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.D-07
Center : [0.0002 0.0002]
Size : 0.0005
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.D-07, x=0.0005 0
Vertex #3/3 : fv=2.D-07, x=0 0.0005
Reflect
xbar=0.0002 0
Function Evaluation #54 at [0.0005 -0.0005]
xr=0.0005 -0.0005, f(xr)=0.000000
xbar2=0 0.0002
Function Evaluation #55 at [-0.0005 0.0005]
xr2=-0.0005 0.0005, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #56 at [0.0002 0]
Function Evaluation #57 at [0 0.0002]
=================================================================
Iteration #17 (total = 17)
Function Eval #57
Xopt : [0 0]
Fopt : 0
DeltaFv : 6.D-08
Center : [8.D-05 8.D-05]
Size : 0.0002
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=6.D-08, x=0.0002 0
Vertex #3/3 : fv=6.D-08, x=0 0.0002
Reflect
xbar=0.0001 0
Function Evaluation #58 at [0.0002 -0.0002]
xr=0.0002 -0.0002, f(xr)=0.000000
xbar2=0 0.0001
Function Evaluation #59 at [-0.0002 0.0002]
xr2=-0.0002 0.0002, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #60 at [0.0001 0]
Function Evaluation #61 at [0 0.0001]
=================================================================
Iteration #18 (total = 18)
Function Eval #61
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.D-08
Center : [4.D-05 4.D-05]
Size : 0.0001
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.D-08, x=0.0001 0
Vertex #3/3 : fv=1.D-08, x=0 0.0001
Reflect
xbar=6.D-05 0
Function Evaluation #62 at [0.0001 -0.0001]
xr=0.0001 -0.0001, f(xr)=0.000000
xbar2=0 6.D-05
Function Evaluation #63 at [-0.0001 0.0001]
xr2=-0.0001 0.0001, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #64 at [6.D-05 0]
Function Evaluation #65 at [0 6.D-05]
=================================================================
Iteration #19 (total = 19)
Function Eval #65
Xopt : [0 0]
Fopt : 0
DeltaFv : 4.D-09
Center : [2.D-05 2.D-05]
Size : 6.D-05
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=4.D-09, x=6.D-05 0
Vertex #3/3 : fv=4.D-09, x=0 6.D-05
Reflect
xbar=3.D-05 0
Function Evaluation #66 at [6.D-05 -6.D-05]
xr=6.D-05 -6.D-05, f(xr)=0.000000
xbar2=0 3.D-05
Function Evaluation #67 at [-6.D-05 6.D-05]
xr2=-6.D-05 6.D-05, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #68 at [3.D-05 0]
Function Evaluation #69 at [0 3.D-05]
=================================================================
Iteration #20 (total = 20)
Function Eval #69
Xopt : [0 0]
Fopt : 0
DeltaFv : 9.D-10
Center : [1.D-05 1.D-05]
Size : 3.D-05
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=9.D-10, x=3.D-05 0
Vertex #3/3 : fv=9.D-10, x=0 3.D-05
Reflect
xbar=2.D-05 0
Function Evaluation #70 at [3.D-05 -3.D-05]
xr=3.D-05 -3.D-05, f(xr)=0.000000
xbar2=0 2.D-05
Function Evaluation #71 at [-3.D-05 3.D-05]
xr2=-3.D-05 3.D-05, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #72 at [2.D-05 0]
Function Evaluation #73 at [0 2.D-05]
=================================================================
Iteration #21 (total = 21)
Function Eval #73
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.D-10
Center : [5.D-06 5.D-06]
Size : 2.D-05
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.D-10, x=2.D-05 0
Vertex #3/3 : fv=2.D-10, x=0 2.D-05
Reflect
xbar=8.D-06 0
Function Evaluation #74 at [2.D-05 -2.D-05]
xr=2.D-05 -2.D-05, f(xr)=0.000000
xbar2=0 8.D-06
Function Evaluation #75 at [-2.D-05 2.D-05]
xr2=-2.D-05 2.D-05, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #76 at [8.D-06 0]
Function Evaluation #77 at [0 8.D-06]
=================================================================
Iteration #22 (total = 22)
Function Eval #77
Xopt : [0 0]
Fopt : 0
DeltaFv : 6.D-11
Center : [3.D-06 3.D-06]
Size : 8.D-06
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=6.D-11, x=8.D-06 0
Vertex #3/3 : fv=6.D-11, x=0 8.D-06
Reflect
xbar=4.D-06 0
Function Evaluation #78 at [8.D-06 -8.D-06]
xr=8.D-06 -8.D-06, f(xr)=0.000000
xbar2=0 4.D-06
Function Evaluation #79 at [-8.D-06 8.D-06]
xr2=-8.D-06 8.D-06, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #80 at [4.D-06 0]
Function Evaluation #81 at [0 4.D-06]
=================================================================
Iteration #23 (total = 23)
Function Eval #81
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.D-11
Center : [1.D-06 1.D-06]
Size : 4.D-06
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.D-11, x=4.D-06 0
Vertex #3/3 : fv=1.D-11, x=0 4.D-06
Reflect
xbar=2.D-06 0
Function Evaluation #82 at [4.D-06 -4.D-06]
xr=4.D-06 -4.D-06, f(xr)=0.000000
xbar2=0 2.D-06
Function Evaluation #83 at [-4.D-06 4.D-06]
xr2=-4.D-06 4.D-06, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #84 at [2.D-06 0]
Function Evaluation #85 at [0 2.D-06]
=================================================================
Iteration #24 (total = 24)
Function Eval #85
Xopt : [0 0]
Fopt : 0
DeltaFv : 4.D-12
Center : [6.D-07 6.D-07]
Size : 2.D-06
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=4.D-12, x=2.D-06 0
Vertex #3/3 : fv=4.D-12, x=0 2.D-06
Reflect
xbar=1.D-06 0
Function Evaluation #86 at [2.D-06 -2.D-06]
xr=2.D-06 -2.D-06, f(xr)=0.000000
xbar2=0 1.D-06
Function Evaluation #87 at [-2.D-06 2.D-06]
xr2=-2.D-06 2.D-06, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #88 at [1.D-06 0]
Function Evaluation #89 at [0 1.D-06]
=================================================================
Iteration #25 (total = 25)
Function Eval #89
Xopt : [0 0]
Fopt : 0
DeltaFv : 9.D-13
Center : [3.D-07 3.D-07]
Size : 1.D-06
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=9.D-13, x=1.D-06 0
Vertex #3/3 : fv=9.D-13, x=0 1.D-06
Reflect
xbar=5.D-07 0
Function Evaluation #90 at [1.D-06 -1.D-06]
xr=1.D-06 -1.D-06, f(xr)=0.000000
xbar2=0 5.D-07
Function Evaluation #91 at [-1.D-06 1.D-06]
xr2=-1.D-06 1.D-06, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #92 at [5.D-07 0]
Function Evaluation #93 at [0 5.D-07]
=================================================================
Iteration #26 (total = 26)
Function Eval #93
Xopt : [0 0]
Fopt : 0
DeltaFv : 2.D-13
Center : [2.D-07 2.D-07]
Size : 5.D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=2.D-13, x=5.D-07 0
Vertex #3/3 : fv=2.D-13, x=0 5.D-07
Reflect
xbar=2.D-07 0
Function Evaluation #94 at [5.D-07 -5.D-07]
xr=5.D-07 -5.D-07, f(xr)=0.000000
xbar2=0 2.D-07
Function Evaluation #95 at [-5.D-07 5.D-07]
xr2=-5.D-07 5.D-07, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #96 at [2.D-07 0]
Function Evaluation #97 at [0 2.D-07]
=================================================================
Iteration #27 (total = 27)
Function Eval #97
Xopt : [0 0]
Fopt : 0
DeltaFv : 6.D-14
Center : [8.D-08 8.D-08]
Size : 2.D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=6.D-14, x=2.D-07 0
Vertex #3/3 : fv=6.D-14, x=0 2.D-07
Reflect
xbar=1.D-07 0
Function Evaluation #98 at [2.D-07 -2.D-07]
xr=2.D-07 -2.D-07, f(xr)=0.000000
xbar2=0 1.D-07
Function Evaluation #99 at [-2.D-07 2.D-07]
xr2=-2.D-07 2.D-07, f(xr2)=0.000000
  > Perform Shrink
Function Evaluation #100 at [1.D-07 0]
Function Evaluation #101 at [0 1.D-07]
=================================================================
Iteration #28 (total = 28)
Function Eval #101
Xopt : [0 0]
Fopt : 0
DeltaFv : 1.D-14
Center : [4.D-08 4.D-08]
Size : 1.D-07
Optim Simplex Object:
=====================
Vertex #1/3 : fv=0, x=0 0
Vertex #2/3 : fv=1.D-14, x=1.D-07 0
Vertex #3/3 : fv=1.D-14, x=0 1.D-07
Terminate with status : maxfuneval
xopt = neldermead_get(nm,"-xopt");
assert_checkalmostequal ( xopt , [0.0;0.0], 1e-6 );
fopt = neldermead_get(nm,"-fopt");
assert_checkalmostequal ( fopt , 0.0, 1e-6 );
nm = neldermead_destroy(nm);
