// ============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2011 - DIGITEO - Clément DAVID
//
//  This file is distributed under the same license as the Scilab package.
// ============================================================================
//
// <-- XCOS TEST -->
//
// <-- Short Description -->
// Check all the possible errors which should be reported on the diagram.
//-----------------------------------------------------------------------------
// at edition (sb port numbering)
//-----------------------------------------------------------------------------
// Check the report against wrong port numbering on super block
assert_checktrue(importXcosDiagram(SCI + "/modules/xcos/tests/unit_tests/error_sb_port_numbering.xcos"));
scicos_simulate(scs_m, "nw")
 ans  =
 
 
       ans(1)
 
    0.  
 
       ans(2)
 
 
        ans(2)(1)
 
!cpr  state  sim  cor  corinv  !
 
        ans(2)(2)
 
 
         ans(2)(2)(1)
 
!xcs  x  z  oz  iz  tevts  evtspt  pointi  outtb  !
 
         ans(2)(2)(2)
 
     []
 
         ans(2)(2)(3)
 
     []
 
         ans(2)(2)(4)
 
     ()
 
         ans(2)(2)(5)
 
    0.         
    0.         
    0.         
    2.45D-316  
    0.         
    0.         
    0.         
    0.         
    0.         
 
         ans(2)(2)(6)
 
    100000.  
 
         ans(2)(2)(7)
 
    0.  
 
         ans(2)(2)(8)
 
    1.  
 
         ans(2)(2)(9)
 
 
          ans(2)(2)(9)(1)
 
    1.  
 
          ans(2)(2)(9)(2)
 
    2.  
 
          ans(2)(2)(9)(3)
 
    2.  
 
          ans(2)(2)(9)(4)
 
    4.  
 
          ans(2)(2)(9)(5)
 
    4.  
 
          ans(2)(2)(9)(6)
 
    4.  
    4.  
 
          ans(2)(2)(9)(7)
 
    1.  
 
        ans(2)(3)
 
 
         ans(2)(3)(1)
 
 
         column  1 to 10
 
!scs  funs  xptr  zptr  ozptr  zcptr  inpptr  outptr  inplnk  outlnk  !
 
         column 11 to 19
 
!rpar  rpptr  ipar  ipptr  opar  opptr  clkptr  ordptr  execlk  !
 
         column 20 to 29
 
!ordclk  cord  oord  zord  critev  nb  ztyp  nblk  ndcblk  subscr  !
 
         column 30 to 33
 
!funtyp  iord  labels  modptr  !
 
         ans(2)(3)(2)
 
 
          ans(2)(3)(2)(1)
 
 cstblk4_m   
 
          ans(2)(3)(2)(2)
 
 cstblk4_m   
 
          ans(2)(3)(2)(3)
 
 trash   
 
          ans(2)(3)(2)(4)
 
 evtdly4   
 
          ans(2)(3)(2)(5)
 
 multiplex   
 
          ans(2)(3)(2)(6)
 
 sum   
 
          ans(2)(3)(2)(7)
 
 sum   
 
          ans(2)(3)(2)(8)
 
 sum   
 
          ans(2)(3)(2)(9)
 
 sum   
 
         ans(2)(3)(3)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(4)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(5)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(6)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(7)
 
    1.   
    1.   
    1.   
    2.   
    2.   
    4.   
    6.   
    8.   
    10.  
    12.  
 
         ans(2)(3)(8)
 
    1.  
    2.  
    3.  
    3.  
    3.  
    4.  
    5.  
    6.  
    7.  
    8.  
 
         ans(2)(3)(9)
 
    6.  
    5.  
    4.  
    1.  
    1.  
    3.  
    2.  
    3.  
    2.  
    1.  
    1.  
 
         ans(2)(3)(10)
 
    1.  
    7.  
    6.  
    3.  
    5.  
    4.  
    2.  
 
         ans(2)(3)(11)
 
    0.1  
    0.1  
    1.   
    1.   
    1.   
    1.   
    1.   
    1.   
    1.   
    1.   
 
         ans(2)(3)(12)
 
    1.   
    1.   
    1.   
    1.   
    3.   
    3.   
    5.   
    7.   
    9.   
    11.  
 
         ans(2)(3)(13)
 
    2.  
 
         ans(2)(3)(14)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    2.  
    2.  
    2.  
    2.  
    2.  
 
         ans(2)(3)(15)
 
 
          ans(2)(3)(15)(1)
 
    1.  
 
          ans(2)(3)(15)(2)
 
    1.  
 
         ans(2)(3)(16)
 
    1.  
    2.  
    3.  
    3.  
    3.  
    3.  
    3.  
    3.  
    3.  
    3.  
 
         ans(2)(3)(17)
 
    1.  
    1.  
    1.  
    1.  
    2.  
    2.  
    2.  
    2.  
    2.  
    2.  
 
         ans(2)(3)(18)
 
    1.  
    3.  
 
         ans(2)(3)(19)
 
    3.    1.  
    4.    1.  
 
         ans(2)(3)(20)
 
    3.    1.  
    4.    1.  
 
         ans(2)(3)(21)
 
     []
 
         ans(2)(3)(22)
 
     []
 
         ans(2)(3)(23)
 
     []
 
         ans(2)(3)(24)
 
    0.  
 
         ans(2)(3)(25)
 
    9.  
 
         ans(2)(3)(26)
 
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
 
         ans(2)(3)(27)
 
    9.  
 
         ans(2)(3)(28)
 
    0.  
 
         ans(2)(3)(29)
 
     []
 
         ans(2)(3)(30)
 
    4.  
    4.  
    0.  
    4.  
    4.  
    2.  
    2.  
    2.  
    2.  
 
         ans(2)(3)(31)
 
    1.    0.  
    2.    0.  
    6.    3.  
    9.    3.  
    7.    3.  
    8.    3.  
    5.    3.  
 
         ans(2)(3)(32)
 
!36c3d623:134d7551ac7:-7fdd  !
!                            !
!36c3d623:134d7551ac7:-7fdb  !
!                            !
!36c3d623:134d7551ac7:-7fd9  !
!                            !
!36c3d623:134d7551ac7:-7f87  !
!                            !
!36c3d623:134d7551ac7:-7fd3  !
!                            !
!36c3d623:134d7551ac7:-7fcb  !
!                            !
!36c3d623:134d7551ac7:-7fc3  !
!                            !
!36c3d623:134d7551ac7:-7fbf  !
!                            !
!36c3d623:134d7551ac7:-7fc7  !
 
         ans(2)(3)(33)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
        ans(2)(4)
 
 
         ans(2)(4)(1)
 
    1.  
 
         ans(2)(4)(2)
 
    2.  
 
         ans(2)(4)(3)
 
    3.  
 
         ans(2)(4)(4)
 
 
          ans(2)(4)(4)(1)
 
    4.  
 
          ans(2)(4)(4)(2)
 
    0.  
 
          ans(2)(4)(4)(3)
 
    10.  
 
          ans(2)(4)(4)(4)
 
    0.  
 
          ans(2)(4)(4)(5)
 
    0.  
 
          ans(2)(4)(4)(6)
 
    0.  
 
         ans(2)(4)(5)
 
    5.  
 
         ans(2)(4)(6)
 
 
          ans(2)(4)(6)(1)
 
    0.  
 
          ans(2)(4)(6)(2)
 
    6.  
 
          ans(2)(4)(6)(3)
 
    10.  
 
          ans(2)(4)(6)(4)
 
    7.  
 
          ans(2)(4)(6)(5)
 
    0.  
 
          ans(2)(4)(6)(6)
 
    10.  
 
          ans(2)(4)(6)(7)
 
    8.  
 
          ans(2)(4)(6)(8)
 
    0.  
 
          ans(2)(4)(6)(9)
 
    9.  
 
          ans(2)(4)(6)(10)
 
    0.  
 
          ans(2)(4)(6)(11)
 
    10.  
 
          ans(2)(4)(6)(12)
 
    10.  
 
          ans(2)(4)(6)(13)
 
    0.  
 
          ans(2)(4)(6)(14)
 
    0.  
 
          ans(2)(4)(6)(15)
 
    0.  
 
          ans(2)(4)(6)(16)
 
    0.  
 
          ans(2)(4)(6)(17)
 
    0.  
 
          ans(2)(4)(6)(18)
 
    0.  
 
          ans(2)(4)(6)(19)
 
    0.  
 
          ans(2)(4)(6)(20)
 
    0.  
 
          ans(2)(4)(6)(21)
 
    0.  
 
          ans(2)(4)(6)(22)
 
    0.  
 
          ans(2)(4)(6)(23)
 
    0.  
 
          ans(2)(4)(6)(24)
 
    0.  
 
          ans(2)(4)(6)(25)
 
    0.  
 
          ans(2)(4)(6)(26)
 
    0.  
 
         ans(2)(4)(7)
 
    0.  
 
         ans(2)(4)(8)
 
    0.  
 
         ans(2)(4)(9)
 
    0.  
 
         ans(2)(4)(10)
 
    0.  
 
         ans(2)(4)(11)
 
    0.  
 
         ans(2)(4)(12)
 
    0.  
 
        ans(2)(5)
 
 
         ans(2)(5)(1)
 
    1.  
 
         ans(2)(5)(2)
 
    2.  
 
         ans(2)(5)(3)
 
    3.  
 
         ans(2)(5)(4)
 
    4.    1.  
 
         ans(2)(5)(5)
 
    5.  
 
         ans(2)(5)(6)
 
    6.    2.  
 
         ans(2)(5)(7)
 
    6.    4.  
 
         ans(2)(5)(8)
 
    6.    7.  
 
         ans(2)(5)(9)
 
    6.    9.  
 
       ans(3)
 
  F  
 
       ans(4)
 
  T  
 
       ans(5)
 
    0.  
 
       ans(6)
 
 
        ans(6)(1)
 
!xcs  x  z  oz  iz  tevts  evtspt  pointi  outtb  !
 
        ans(6)(2)
 
     []
 
        ans(6)(3)
 
     []
 
        ans(6)(4)
 
     ()
 
        ans(6)(5)
 
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
    0.  
 
        ans(6)(6)
 
    0.1  
 
        ans(6)(7)
 
    0.  
 
        ans(6)(8)
 
    1.  
 
        ans(6)(9)
 
 
         ans(6)(9)(1)
 
    0.  
 
         ans(6)(9)(2)
 
    0.  
 
         ans(6)(9)(3)
 
    0.  
 
         ans(6)(9)(4)
 
    0.  
 
         ans(6)(9)(5)
 
    0.  
 
         ans(6)(9)(6)
 
    0.  
    0.  
 
         ans(6)(9)(7)
 
    0.  
//-----------------------------------------------------------------------------
// on do_eval (context evaluation)
//-----------------------------------------------------------------------------
// Check the report against an invalid context value
assert_checktrue(importXcosDiagram(SCI + "/modules/xcos/tests/unit_tests/error_blocks_with_updated_context.xcos"));
scicos_simulate(scs_m, "nw")
 
!Problème d'évaluation : La valeur n'est pas mise à jour à partir d!
!     u contexte.                                                      !
!                                                                      !
!Initial condition x0 should be inside the limits                      !
 ans  =
 
 
       ans(1)
 
    0.  
 
       ans(2)
 
 
        ans(2)(1)
 
!cpr  state  sim  cor  corinv  !
 
        ans(2)(2)
 
 
         ans(2)(2)(1)
 
!xcs  x  z  oz  iz  tevts  evtspt  pointi  outtb  !
 
         ans(2)(2)(2)
 
    1.  
 
         ans(2)(2)(3)
 
     []
 
         ans(2)(2)(4)
 
     ()
 
         ans(2)(2)(5)
 
    0.         
    0.         
    2.46D-316  
    0.         
    0.         
 
         ans(2)(2)(6)
 
    30.  
 
         ans(2)(2)(7)
 
    0.  
 
         ans(2)(2)(8)
 
    1.  
 
         ans(2)(2)(9)
 
 
          ans(2)(2)(9)(1)
 
    1.  
 
          ans(2)(2)(9)(2)
 
    1.  
 
          ans(2)(2)(9)(3)
 
    9.481D-14  
 
        ans(2)(3)
 
 
         ans(2)(3)(1)
 
 
         column  1 to 10
 
!scs  funs  xptr  zptr  ozptr  zcptr  inpptr  outptr  inplnk  outlnk  !
 
         column 11 to 19
 
!rpar  rpptr  ipar  ipptr  opar  opptr  clkptr  ordptr  execlk  !
 
         column 20 to 29
 
!ordclk  cord  oord  zord  critev  nb  ztyp  nblk  ndcblk  subscr  !
 
         column 30 to 33
 
!funtyp  iord  labels  modptr  !
 
         ans(2)(3)(2)
 
 
          ans(2)(3)(2)(1)
 
 sum   
 
          ans(2)(3)(2)(2)
 
 integral_func   
 
          ans(2)(3)(2)(3)
 
 evtdly4   
 
          ans(2)(3)(2)(4)
 
 trash   
 
          ans(2)(3)(2)(5)
 
 cstblk4_m   
 
         ans(2)(3)(3)
 
    1.  
    1.  
    2.  
    2.  
    2.  
    2.  
 
         ans(2)(3)(4)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(5)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(6)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
         ans(2)(3)(7)
 
    1.  
    3.  
    4.  
    4.  
    5.  
    5.  
 
         ans(2)(3)(8)
 
    1.  
    2.  
    3.  
    3.  
    3.  
    4.  
 
         ans(2)(3)(9)
 
    2.  
    1.  
    3.  
    1.  
 
         ans(2)(3)(10)
 
    3.  
    1.  
    2.  
 
         ans(2)(3)(11)
 
    1.      
  - 1.      
    1.      
    0.0001  
    0.01    
    0.      
    0.      
    30.     
    0.      
    1.05    
 
         ans(2)(3)(12)
 
    1.   
    3.   
    5.   
    7.   
    11.  
    11.  
 
         ans(2)(3)(13)
 
  - 1.   
    1.   
    20.  
  - 1.   
  - 1.   
  - 1.   
  - 1.   
    1.   
    5.   
    0.   
 
         ans(2)(3)(14)
 
    1.   
    1.   
    1.   
    1.   
    11.  
    11.  
 
         ans(2)(3)(15)
 
 
          ans(2)(3)(15)(1)
 
    1.  
 
         ans(2)(3)(16)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    2.  
 
         ans(2)(3)(17)
 
    1.  
    1.  
    1.  
    2.  
    2.  
    2.  
 
         ans(2)(3)(18)
 
    1.  
    5.  
 
         ans(2)(3)(19)
 
    2.    0.  
    3.    1.  
    1.  - 2.  
    4.    1.  
 
         ans(2)(3)(20)
 
    2.    0.  
    3.    1.  
    1.  - 2.  
    4.    1.  
 
         ans(2)(3)(21)
 
    2.    0.  
    1.    2.  
 
         ans(2)(3)(22)
 
    2.    0.  
    1.    2.  
 
         ans(2)(3)(23)
 
     []
 
         ans(2)(3)(24)
 
    1.  
 
         ans(2)(3)(25)
 
    5.  
 
         ans(2)(3)(26)
 
    0.  
    0.  
    0.  
    0.  
    0.  
 
         ans(2)(3)(27)
 
    5.  
 
         ans(2)(3)(28)
 
    0.  
 
         ans(2)(3)(29)
 
     []
 
         ans(2)(3)(30)
 
    2.  
    4.  
    4.  
    4.  
    4.  
 
         ans(2)(3)(31)
 
    2.    0.  
    5.    0.  
    1.    3.  
 
         ans(2)(3)(32)
 
!-7bfcd901:1324c17114e:-7eeb  !
!                             !
!6e4ff2ae:1324c23ab12:-7eb8   !
!                             !
!43433c5f:13271367d12:-7fb8   !
!                             !
!                             !
!                             !
!-1e395597:1326bdf1455:-7f15  !
 
         ans(2)(3)(33)
 
    1.  
    1.  
    1.  
    1.  
    1.  
    1.  
 
        ans(2)(4)
 
 
         ans(2)(4)(1)
 
    1.  
 
         ans(2)(4)(2)
 
    2.  
 
         ans(2)(4)(3)
 
 
          ans(2)(4)(3)(1)
 
    3.  
 
          ans(2)(4)(3)(2)
 
    0.  
 
          ans(2)(4)(3)(3)
 
    6.  
 
          ans(2)(4)(3)(4)
 
    0.  
 
          ans(2)(4)(3)(5)
 
    0.  
 
          ans(2)(4)(3)(6)
 
    0.  
 
         ans(2)(4)(4)
 
    4.  
 
         ans(2)(4)(5)
 
    5.  
 
         ans(2)(4)(6)
 
    6.  
 
         ans(2)(4)(7)
 
    0.  
 
         ans(2)(4)(8)
 
    0.  
 
         ans(2)(4)(9)
 
    0.  
 
         ans(2)(4)(10)
 
    0.  
 
         ans(2)(4)(11)
 
    0.  
 
         ans(2)(4)(12)
 
    0.  
 
        ans(2)(5)
 
 
         ans(2)(5)(1)
 
    1.  
 
         ans(2)(5)(2)
 
    2.  
 
         ans(2)(5)(3)
 
    3.    1.  
 
         ans(2)(5)(4)
 
    4.  
 
         ans(2)(5)(5)
 
    5.  
 
       ans(3)
 
  F  
 
       ans(4)
 
  T  
 
       ans(5)
 
    0.  
 
       ans(6)
 
 
        ans(6)(1)
 
!xcs  x  z  oz  iz  tevts  evtspt  pointi  outtb  !
 
        ans(6)(2)
 
    0.1  
 
        ans(6)(3)
 
     []
 
        ans(6)(4)
 
     ()
 
        ans(6)(5)
 
    0.  
    0.  
    0.  
    0.  
    0.  
 
        ans(6)(6)
 
    0.  
 
        ans(6)(7)
 
    0.  
 
        ans(6)(8)
 
    1.  
 
        ans(6)(9)
 
 
         ans(6)(9)(1)
 
    0.  
 
         ans(6)(9)(2)
 
    0.  
 
         ans(6)(9)(3)
 
    0.  
