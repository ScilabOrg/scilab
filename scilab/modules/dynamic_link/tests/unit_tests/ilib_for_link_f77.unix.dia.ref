// ============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008 - INRIA - Michael Baudin
//
//  This file is distributed under the same license as the Scilab package.
// ============================================================================
//
// Test fortran 77 dynamic link.
//
cwd = pwd();
cd TMPDIR;
sourcecode=['      subroutine incrdoublef77(x,y)'
    '      implicit none'
    '      double precision x'
    '      double precision y'
    '      y=x+1'
    '      end'];
mputl(sourcecode,'incrdoublef77.f');
libpath=ilib_for_link('incrdoublef77','incrdoublef77.o',[],'f','Makefile');
   Génère un fichier loader
   Génère un Makefile
   ilib_gen_Make: Copie les fichiers de compilation (Makefile*, libtool...) vers TMPDIR
   ilib_gen_Make: Copie incrdoublef77.f vers TMPDIR
   ilib_gen_Make: Modification du Makefile dans TMPDIR.
   Exécute le Makefile
exec loader.sce;
Bibliothèque partagée chargée.
Link done.
n=1.
 n  =
 
    1.  
m=call("incrdoublef77",n,1,"d","out",[1,1],2,"d");
if abs(m-2.)>%eps then bugmes();quit;end
chdir(cwd);
