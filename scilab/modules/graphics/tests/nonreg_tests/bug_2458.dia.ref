// =============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008-2008 - INRIA - Jean-Baptiste Silvy
//
//  This file is distributed under the same license as the Scilab package.
// =============================================================================
// <-- TEST WITH GRAPHIC -->
// <-- Non-regression test for bug 2458 -->
//
// <-- Bugzilla URL -->
// http://bugzilla.scilab.org/show_bug.cgi?id=2458
//
// <-- Short Description -->
//Under linux Suse 10.2, with build4, official build of 4.1.1
// and 4.1 there is a memory leak relative to show_pixmap()
nbComputation = 20000
 nbComputation  =
 
    20000.  
// force full allocation of free
free(nbComputation) = 0;
f=gcf();f.pixmap='on';
plot2d()
free=getmemory();
for k=1:nbComputation, show_pixmap(),free(k) = getmemory();end
// compute used memory during compuations
usedMemory = free(1) - free(nbComputation);
// 5 mega
if (usedMemory > 5000) then bugmes();quit;end
